<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Time</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#6a5acd;
  --accent:#00c9a7;
  --bg:#f3f4f8;
  --card:#ffffff;
  --muted:#6b7280;
  --border:#e5e7eb;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Inter,system-ui,Segoe UI,Roboto;
  background:var(--bg);
  padding:16px;
}

.card{
  max-width:1000px;
  margin:auto;
  background:var(--card);
  border-radius:24px;
  padding:24px;
  box-shadow:0 20px 40px rgba(0,0,0,.12);
}

h2{
  margin:0 0 16px;
  text-align:center;
}

label{
  font-size:12px;
  font-weight:600;
  color:var(--muted);
}

input,select,textarea,button{
  font-size:14px;
}

input,textarea{
  width:100%;
  padding:10px;
  border-radius:12px;
  border:1px solid var(--border);
}

textarea{
  resize:vertical;
  min-height:38px;
}

button{
  border:none;
  border-radius:12px;
  padding:12px;
  cursor:pointer;
  font-weight:600;
}

.btn{
  background:var(--primary);
  color:white;
}

.btn-alt{
  background:#f3f4f6;
}

.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.row>div{flex:1}

.block{
  display:grid;
  grid-template-columns:160px 1fr 80px;
  gap:10px;
  padding:14px;
  border-radius:16px;
  background:#f9fafb;
  margin-bottom:10px;
}

.block.done{
  background:rgba(0,201,167,.15);
}

.time{
  font-weight:600;
}

.actions{
  display:flex;
  gap:6px;
}

.small{
  padding:6px 10px;
  font-size:12px;
}

footer{
  margin-top:20px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
</style>
</head>

<body>

<div class="card">
  <h2>My Time</h2>

  <label>Date</label>
  <input type="date" id="date">

  <div class="row" style="margin-top:12px">
    <div>
      <label>Default Gap (hours)</label>
      <select id="gap">
        <option value="1">1 hour</option>
        <option value="2" selected>2 hours</option>
        <option value="3">3 hours</option>
      </select>
    </div>
    <div style="align-self:end">
      <button class="btn" onclick="generate()">Generate Day</button>
    </div>
  </div>

  <hr style="margin:16px 0">

  <div id="blocks"></div>

  <footer>
    <button class="btn" onclick="backup()">Backup</button>
    <button class="btn-alt" onclick="restore()">Restore</button>
    <input type="file" id="file" hidden>
  </footer>
</div>

<script>
const dateEl=document.getElementById("date");
const blocksEl=document.getElementById("blocks");
dateEl.value=new Date().toISOString().split("T")[0];

function store(d){localStorage.setItem("myTimeData",JSON.stringify(d))}
function loadStore(){return JSON.parse(localStorage.getItem("myTimeData")||"{}")}

function toAMPM(h){
  const a=h>=12?"PM":"AM";
  const x=((h+11)%12+1);
  return x+":00 "+a;
}

function generate(){
  const gap=+document.getElementById("gap").value;
  const all=loadStore();
  const day=[];
  for(let h=0;h<24;h+=gap){
    day.push({
      start:h,
      end:(h+gap)%24,
      text:"",
      done:false
    });
  }
  all[dateEl.value]=day;
  store(all);
  render();
}

function render(){
  blocksEl.innerHTML="";
  const day=loadStore()[dateEl.value]||[];
  day.forEach((b,i)=>{
    const div=document.createElement("div");
    div.className="block"+(b.done?" done":"");
    div.innerHTML=`
      <div class="time">${toAMPM(b.start)} – ${toAMPM(b.end)}</div>
      <textarea onchange="edit(${i},this.value)">${b.text}</textarea>
      <div class="actions">
        <button class="small" onclick="toggle(${i})">✔</button>
        <button class="small" onclick="removeBlock(${i})">✕</button>
      </div>
    `;
    blocksEl.appendChild(div);
  });
}

function edit(i,v){
  const all=loadStore();
  all[dateEl.value][i].text=v;
  store(all);
}

function toggle(i){
  const all=loadStore();
  all[dateEl.value][i].done=!all[dateEl.value][i].done;
  store(all);render();
}

function removeBlock(i){
  const all=loadStore();
  all[dateEl.value].splice(i,1);
  store(all);render();
}

function backup(){
  const d=localStorage.getItem("myTimeData");
  if(!d)return alert("Nothing to backup");
  const b=new Blob([d],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="my-time-backup.json";
  a.click();
}

function restore(){
  document.getElementById("file").click();
}
document.getElementById("file").onchange=e=>{
  const f=e.target.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=()=>{store(JSON.parse(r.result));render();}
  r.readAsText(f);
};

dateEl.onchange=render;
render();
</script>

</body>
</html>
